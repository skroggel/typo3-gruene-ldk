<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      data-namespace-typo3-fluid="true"
>

    <f:if condition="{menuItems}">
        <f:for each="{menuItems}" as="menuItem" iteration="iterator">
            <f:variable name="title">{f:if(condition: '{noHtml}', then: '{menuItem.data.title}', else: '{menuItem.title}')}</f:variable>
            <f:variable name="id">{f:if(condition: '{hasKeyboardEntryPoint} && {iterator.cycle} == 1', then: 'first-menu-item', else: 'menu-item-{menuItem.data.uid}')}</f:variable>

            <li class="nav-inline-item nav-main-item level-1{f:if(condition:'{menuItem.active}', then:' active')}"
                role="none">

                <f:if condition="{menuItem.children}">
                    <f:comment><!-- Variant with submenu --></f:comment>
                    <f:then>
                        <a class="nav-inline-link nav-main-link js-flyout-toggle level-1{f:if(condition:'{menuItem.active}', then:' active')}"
                           href="{menuItem.link}"
                           id="{id}"
                           target="{menuItem.target}"
                           title="{menuItem.data.title}"
                           role="menuitem"
                           aria-label="Open menu"
                           aria-controls="nav-main-flyout-{menuItem.data.uid}"
                           aria-haspopup="true"
                           aria-expanded="false">
                               <span><f:format.html parseFuncTSPath="lib.parseFunc_Inline">{title}</f:format.html></span>
                        </a>

                        <div class="flyout nav-main-flyout js-flyout"
                             id="nav-main-flyout-{menuItem.data.uid}"
                             data-position-ref="siteheader-inner"
                             data-padding-ref="first-menu-item"
                        >
                            <div class="flyout-container nav-main-flyout-container bg-color-grey-200 js-flyout-container ">
                                <div class="flyout-inner nav-main-flyout-inner js-flyout-inner">
                                    <div class="nav-main-flyout-wrap">
                                        <div class="nav-main-flyout-content p-9">

                                            <p class="headline h2">
                                                <span>
                                                    <f:format.html parseFuncTSPath="lib.parseFunc_Inline">{title}</f:format.html>
                                                </span>
                                            </p>

                                            <div class="toggle-list accordion nav-main-flyout-accordion"
                                                 id="accordion-container-{menuItem.data.uid}"
                                                 role="tablist"
                                            >
                                                <f:render partial="Level2" arguments="{menuItems: menuItem.children, parentItem: menuItem}" />
                                            </div>

                                        </div>
                                    </div>

                                    <div class="nav-main-flyout-toggle-container">
                                        <button class="toggle nav-main-flyout-toggle-close js-flyout-close"
                                                aria-label="{f:translate(key:'menu.close', extensionName:'siteDefault')}"
                                                aria-controls="nav-main-flyout-{menuItem.data.uid}"
                                        >
                                            <span class="icon-close icon toggle-icon"></span>
                                        </button>
                                    </div>

                                    <f:render partial="Utils/Media"
                                              arguments="{
                                                    file: menuItem.imageFlyout.0,
                                                    wrapClass: 'nav-main-flyout-image effect-edge-cut',
                                                    settings: {
                                                        media: {
                                                            image: {
                                                                dimensions: {
                                                                    maxWidth : 1000
                                                                }
                                                            }
                                                        }
                                                    }
                                                }" />
                                </div>


                            </div>
                        </div>
                    </f:then>


                    <f:comment><!-- Variant without submenu --></f:comment>
                    <f:else>
                        <a class="nav-inline-link nav-main-link level-1{f:if(condition:'{menuItem.active}', then:' active')}"
                           href="{f:if(condition:'{menuItem.data.tx_klarokratie_open_modal}', then:'#', else:'{menuItem.link}')}"
                           id="{id}"
                           {f:if(condition:'{menuItem.data.tx_klarokratie_open_modal}', then:'onclick="javascript:klaro.show(undefined, true);return false;"')}
                           target="{menuItem.target}"
                           title="{menuItem.data.title}"
                           role="menuitem">
                                <span><f:format.html parseFuncTSPath="lib.parseFunc_Inline">{title}</f:format.html></span>
                        </a>
                    </f:else>
                </f:if>
            </li>
        </f:for>
    </f:if>

</html>
